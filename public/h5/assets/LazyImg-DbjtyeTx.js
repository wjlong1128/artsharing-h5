import{d as L,r as d,s as c,o as b,x as M,_ as y,c as Z,a as B,y as W}from"./index-CyFXM-3y.js";const w=L({name:"LazyImage",inheritAttrs:!1,props:{src:{type:String,required:!0},placeholder:{type:String,default:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMDAgMTUwIj48cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ0ZXh0IiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTYiPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+"},rootMargin:{type:String,default:"0px"},threshold:{type:Number,default:.1},nativeLoading:{type:Boolean,default:!0}},setup(e,{attrs:t}){const o=d(null),a=d(!1),u=d(!1),r=d(null),i=c(()=>{const{src:s,placeholder:n,rootMargin:T,threshold:A,nativeLoading:C,...p}=t;return p}),g=c(()=>e.nativeLoading&&"loading"in HTMLImageElement.prototype||a.value?e.src:e.placeholder),m=c(()=>e.nativeLoading&&"loading"in HTMLImageElement.prototype?"lazy":"eager"),v=()=>{a.value=!0,u.value=!1},f=()=>{u.value=!0,l()},h=()=>{if(o.value&&!(e.nativeLoading&&"loading"in HTMLImageElement.prototype)){if(I(o.value)){a.value=!0,l();return}r.value=new IntersectionObserver(s=>{s.forEach(n=>{n.isIntersecting&&(a.value=!0,l())})},{rootMargin:e.rootMargin,threshold:e.threshold}),r.value.observe(o.value)}},l=()=>{r.value&&(r.value.disconnect(),r.value=null)},I=s=>{const n=s.getBoundingClientRect();return n.top<=window.innerHeight&&n.left<=window.innerWidth&&n.bottom>=0&&n.right>=0};return b(()=>{h()}),M(()=>{l()}),{imgRef:o,filteredAttrs:i,actualSrc:g,loading:m,handleLoad:v,handleError:f}}}),E=["src","loading"];function H(e,t,o,a,u,r){return B(),Z("img",W({ref:"imgRef"},e.filteredAttrs,{src:e.actualSrc,loading:e.loading,onLoad:t[0]||(t[0]=(...i)=>e.handleLoad&&e.handleLoad(...i)),onError:t[1]||(t[1]=(...i)=>e.handleError&&e.handleError(...i))}),null,16,E)}const z=y(w,[["render",H]]);export{z as L};
